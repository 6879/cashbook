<template>
   <span>




     <div class="row mb-3">
                            <div class="col-xs-5 col-sm-5 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper rounded">
                                            <div class="icon-wrapper-bg bg-warning  rounded-circle"></div>
                                            <i class="lnr-laptop-phone text-warning"></i>
                                        </div>
                                        
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                         Customer
                                        </div>
                                         
                                    </div>
                                    
                                    </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-danger"></div>
                                            <i class="lnr-graduation-hat text-danger"></i>
                                        </div>
                                         
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                           Offer
                                        </div>
                                         
                                    </div>
                                   </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover  rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-info"></div>
                                            <i class="lnr-diamond text-info"></i>
                                        </div>
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                            Stock </div>
                                    </div>
                                    </div>
                            </div>

                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover  rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-warning"></div>
                                            <i class="lnr-laptop-phone text-warning"></i>
                                        </div>
                                        
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                           Dues
                                        </div>
                                         
                                    </div>
                                    
                                    </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover  rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-danger"></div>
                                            <i class="lnr-graduation-hat text-danger"></i>
                                        </div>
                                         
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                            Invoice
                                        </div>
                                         
                                    </div>
                                   </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-info"></div>
                                            <i class="lnr-diamond text-info"></i>
                                        </div>
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                            Stock  </div>
                                         
                                    </div>
                                    </div>
                            </div>
                        
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper rounded">
                                            <div class="icon-wrapper-bg bg-warning  rounded-circle"></div>
                                            <i class="lnr-laptop-phone text-warning"></i>
                                        </div>
                                        
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                         Customer
                                        </div>
                                         
                                    </div>
                                    
                                    </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-danger"></div>
                                            <i class="lnr-graduation-hat text-danger"></i>
                                        </div>
                                         
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                           Offer
                                        </div>
                                         
                                    </div>
                                   </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover  rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-info"></div>
                                            <i class="lnr-diamond text-info"></i>
                                        </div>
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                            Stock </div>
                                    </div>
                                    </div>
                            </div>

                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover  rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-warning"></div>
                                            <i class="lnr-laptop-phone text-warning"></i>
                                        </div>
                                        
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                           Dues
                                        </div>
                                         
                                    </div>
                                    
                                    </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover  rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-danger"></div>
                                            <i class="lnr-graduation-hat text-danger"></i>
                                        </div>
                                         
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                            Invoice
                                        </div>
                                         
                                    </div>
                                   </div>
                            </div>
                            <div class="col-sm-12 col-md-2 col-xl-1 p-2 d-none d-xl-block">
                                <div class="card mb-3 widget-chart widget-chart-hover rounded-circle wh-100-100">
                                    <div class="widget-chart-content">
                                        <div class="icon-wrapper  rounded-circle">
                                            <div class="icon-wrapper-bg bg-info"></div>
                                            <i class="lnr-diamond text-info"></i>
                                        </div>
                                        <div class="widget-subheading fsize-1 pt-2 opacity-10 text-dark font-weight-bold position-absolute text-center mt-3">
                                            Stock  </div>
                                         
                                    </div>
                                    </div>
                            </div>
                        </div>







      <div class="card">
      <div class="card-body">
         <div class="no-gutters row border-bottom " style="display:none;">
             <div class="col-sm-12 col-md-2 col-xl-1 d-none d-md-block" data-toggle="modal"  data-target="#customerModal">
                 <div class="card no-shadow rm-border bg-transparent widget-chart text-center">
                     <div class="icon-wrapper rounded-circle mb-2">
                         <div class="icon-wrapper-bg opacity-10 bg-warning"></div>
                         <i class="fa fa-users text-white" aria-hidden="true"></i>
                      </div>
                         <h5>New Customer</h5>
                   </div>
                 <div class="divider m-0 d-md-none d-sm-block"></div>
             </div>
             <div class="col-sm-12 col-md-2 col-xl-1 d-none d-md-block" data-toggle="modal"  data-target="#offerModal">
                  <div class="card no-shadow rm-border bg-transparent widget-chart text-center">
                     <div class="icon-wrapper rounded-circle  mb-2">
                         <div class="icon-wrapper-bg opacity-9 bg-danger"></div>
                         <i class="fa fa-gift text-white" aria-hidden="true"></i>
                     </div>
                      <h5>Offer</h5>
                   </div>
                 <div class="divider m-0 d-md-none d-sm-block"></div>
             </div>
             <div class="col-sm-12 col-md-2 col-xl-1 d-none d-md-block" data-toggle="modal"  data-target="#stockModal">
                 <div class="card no-shadow rm-border bg-transparent widget-chart text-center">
                     <div class="icon-wrapper rounded-circle  mb-2">
                         <div class="icon-wrapper-bg opacity-9 bg-success"></div>
                         <i class="fa fa-database text-white" aria-hidden="true"></i>
                      </div>
                      <h5>Stock</h5>
                   </div>
                <div class="divider m-0 d-md-none d-sm-block"></div>
             </div>
             <div class="col-sm-12 col-md-2 col-xl-1 d-none d-md-block">
                 <div class="card no-shadow rm-border bg-transparent widget-chart text-center">
                     <div class="icon-wrapper rounded-circle  mb-2">
                         <div class="icon-wrapper-bg opacity-9 bg-primary"></div>
                         <i class="lnr-apartment text-white"></i>
                      </div>
                      <h5>Dues <span class="badge badge-info mr-2 text-dark">69</span></h5>
                   </div>
                 <div class="divider m-0 d-md-none d-sm-block"></div>
             </div>
             <div class="col-sm-12 col-md-2 col-xl-1 d-none d-md-block">
                 <div class="card no-shadow rm-border bg-transparent widget-chart text-center">
                     <div class="icon-wrapper rounded-circle  mb-2">
                         <div class="icon-wrapper-bg opacity-9 bg-info"></div>
                         <i class="lnr-apartment text-white"></i>
                      </div>
                      <h5>Today Invoice <span class="badge badge-info mr-2 text-dark">69</span></h5>
                   </div>
               <div class="divider m-0 d-md-none d-sm-block"></div>
             </div>
             <div class="col-sm-12 col-md-2 col-xl-1 d-none d-md-block" data-toggle="modal"  data-target="#stockLimitModal">
                 <div class="card no-shadow rm-border bg-transparent widget-chart text-center">
                     <div class="icon-wrapper rounded-circle  mb-2">
                         <div class="icon-wrapper-bg opacity-9 bg-dark"></div>
                         <i class="lnr-apartment text-white"></i>
                      </div>
                      <h5>Stock Limit <span class="badge badge-info mr-2 text-dark">69</span></h5>
                   </div>
                 <div class="divider m-0 d-md-none d-sm-block"></div>
             </div>

         </div>






         <div class="text-center d-block p-3 border-bottom">
           <div class="col-md-4 offset-md-4">
             <div class="search">
                <form class="" action="" method="post">
                   <input type="text" name="search" placeholder="Search">
                   <button type="button"><i class="fa fa-search" aria-hidden="true"></i></button>
                </form>
             </div>
           </div>
         </div>

         <div class="product-bill px-2 py-4">
             <form>
               <div class="form-row">
                 <div class="form-group mb-0 col-md-2 col-sm-4 col-6">
                     <label>Sales Invoice No</label>
                     <input disabled v-model="form.salesInvoiceNo" name="salesInvoiceNo"  class="form-control"  placeholder="Sales Invoice No"/>
                 </div>
                 <div class="form-group mb-0 col-md-2 col-sm-4 col-6 salesDate">
                     <label>Sales Data</label>
                     <datepicker  v-model="form.salesDate" name="salesDate" :format="customFormatter"  placeholder="Sales Date"></datepicker>
                 </div>
                 <div class="form-group mb-0 col-md-3 col-sm-4 col-6">
                     <label>Cusmter Type</label>
                     <multiselect v-model="form.customerTypeId" name="customerTypeId"  :options="customerTypeLists" @input="customerTypeIdCatch"  :custom-label="customerTypeName"  placeholder="Select one" >
                         <span slot="noResult">Oops! Customer Type Not Found</span>
                     </multiselect>
                 </div>
                 <div class="form-group mb-0 col-md-3 col-sm-4 col-6">
                     <label>Cusmter Name</label>
                     <multiselect v-model="form.salesCustomerEntryId" name="salesCustomerEntryId" :options="salesCustomerLists" @input="customerIdCatch" :custom-label="salesCustomerName"  placeholder="Select one" >
                          <span slot="noResult">Oops! Customer Name Not Found</span>
                     </multiselect>
                 </div>
                 <div class="form-group mb-0 col-md-2 col-sm-4 col-6">
                     <label>Select Price Type</label>
                     <multiselect v-model="form.priceType" 
                     name="priceType" 
                     :options="priceType" 
                     :custom-label="priceName"  
                     placeholder="Select one" >
                          <span slot="noResult">Oops! Price Type Not Found</span>
                     </multiselect>
                 </div>
               </div>
           </form>
         </div>

        <div class="product-page pl-2 alert-success">
             <form @submit.prevent="salesProductEntry()">
               <div class="form-row">
                 <div class="form-group mb-0 col-md-3 col-sm-4 col-6">
                      <label>Product Name</label>
                      <multiselect v-model="form.purchaseProductId" name="purchaseProductId" :options="productPriceLists"  @input="purchaseProductIdCatch" :custom-label="prdouctName"    placeholder="Select one" >
                          <span slot="noResult">Oops! Product Name Not Found</span>
                      </multiselect>
                 </div>
                 <div class="form-group mb-0 col-md-2 col-sm-4 col-6">
                      <label>Brand Name</label>
                      <multiselect v-model="form.brandId" :options="brandLists"   :custom-label="brandName"  placeholder="Select one" >
                          <span slot="noResult">Oops! Product Name Not Found</span>
                      </multiselect>
                 </div>
                 <div class="form-group mb-0 col-md-2 col-sm-4 col-6">
                     <label>Unit</label>
                     <multiselect v-model="form.unitId" name="unitId" :options="uniteLists"  :custom-label="uniteName"  placeholder="Select one" >
                         <span slot="noResult">Oops! Unit Name Not Found</span>
                     </multiselect>
                 </div>
                 <div class="form-group mb-0 col-md-1 col-sm-4 col-6">
                    <label>Quantity</label>
                    <input type="text"  v-model="form.quantity" name="quantity" :class="{ 'is-invalid': form.errors.has('quantity') }" @keyup.prevent="totalPrice()" class="form-control" placeholder="Quantity">
                    <has-error :form="form" field="quantity"></has-error>
                 </div>
                 <div class="form-group mb-0 col-md-1 col-sm-4 col-6">
                    <label>Unit Price</label>
                    <input disabled type="text" v-model="form.unitPrice" :class="{ 'is-invalid': form.errors.has('unitPrice') }" name="unitPrice" class="form-control" placeholder="Unit Price">
                    <has-error :form="form" field="unitPrice"></has-error>
                 </div>
                 <div class="form-group  mb-0 col-md-2 col-sm-4 col-6">
                   <label>Total Price</label>
                   <input disabled type="text" v-model="form.totalPrice" name="totalPrice" class="form-control" placeholder="Total Price">
                 </div>
                 <input  type="hidden" v-model="form.discountPriceHidden" name="discountPriceHidden" class="form-control" placeholder="Total Price">
                 <div class="form-group">
                    <button type="submit" class="btn btn-info btn-padding">Add</button>
                 </div>
               </div>
             </form>
         </div>

        <div class="table-responsive bg-white">
          <table class="table table-hover table-bordered mb-0 ">
            <thead>
               <tr style="background:rgba(242, 242, 242, 0.47)">
                 <th>SN</th>
                 <th>Product Name</th>
                 <th>Brand Name</th>
                 <th>Unit Name</th>
                 <th>Quantity</th>
                 <th>Unit Price</th>
                 <th>Discount Price</th>
                 <th>Total Price</th>
                 <th>Action</th>
               </tr>
              </thead>
              <tbody>
                <tr v-for="(salesProductList, index) in salesProductLists" v-if="salesProductList.salesInvoiceNo == salesInvoiceNoIncre">
                  <td>{{ index+1 }}</td>
                  <td>{{ salesProductList.product_name.productName }} ({{ salesProductList.product_name.productCode }})</td>
                  <td>{{ salesProductList.brand_name.brandName }}</td>
                  <td>{{ salesProductList.unit_name.uniteEntryName }}</td>
                  <td>{{ salesProductList.quantity }}</td>
                  <td>{{ salesProductList.unitPrice }}</td>
                  <td>{{ salesProductList.discountPrice }}</td>
                  <td>{{ salesProductList.totalPrice }}</td>
                   <td>
                     <div class="btn-group text-light product-delete" >
                       <a herf="#" @click.prevent="salesProductDelete(salesProductList.salesProductEntryId)"><i class="fa fa-times" aria-hidden="true"></i></a>
                     </div>
                   </td>
                </tr>
              </tbody>
           </table>
         </div>

          <div class="check-bar py-2 px-2">
            <div class="row">
              <div class="col-md-6 col-6 pl-0">
                 <table class="table">
                   <tr>
                     <td> <input type="radio" name="gander" id="card" class="float-left"> <label class="float-left" for="card"> Card </label> </td>
                    
                     <td> <input type="radio" name="gander" id="Cadit" class="float-left"> <label class="float-left" for="Cadit">Cadit </label> </td>
                   
                     <td> <input type="radio" name="gander" id="Cash" class="float-left"> <label class="float-left" for="Cash">  Cash </label> </td>
                   </tr>
                     
                     
                    
                  </table>
                </div>
               <div class="col-md-6 col-6 p-0 ">
                   <div class="row">
                     <div class="col-md-5">
                         <input type="text" name="" class="form_control">
                     </div>
                     <button type="button" class="btn text-light" style="font-size:16px;background:#2955C8;margin-left: 10px;">Adjust Quantity</button>
                   </div>
               </div>
            </div>
           </div>

          <div class="product-detail pb-4 alert-success">
            <div class="row m-0" >
              <div class="col-lg-9 col-12 p-0 pl-2">
                  <form class="form-row m-0" action="#" method="post">
                      <div class="col-md-6">
                        <div class="form-group m-0 row  mt-2">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Quantity</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text" disabled v-model="form.totalQuantity" class="form-control" placeholder="Quantity">
                            </div>
                        </div>
                        <div class="form-group m-0 row  mt-2">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Balance</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text" disabled v-model="form.totalBalance" class="form-control" placeholder="Balance">
                            </div>
                        </div>
                        <div class="form-group m-0 row  mt-2">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Discount</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text" disabled v-model="form.discountPrice" class="form-control" placeholder="Discount">
                            </div>
                        </div>
                        <div class="form-group m-0 row  mt-2">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Total VAT</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text"  v-model="form.totalVat" @keyup="totalVat()" class="form-control" placeholder="Total VAT">
                            </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="form-group m-0 row  mt-2">
                           <input type="hidden"  v-model="form.vatCalculate" class="form-control" placeholder="Total Payable">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Total Payable</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text" disabled  v-model="form.totalPayable" class="form-control" placeholder="Total Payable">
                            </div>
                        </div>
                        <div class="form-group m-0 row  mt-2">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Previous Due</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text" disabled v-model="form.previousDue" class="form-control" placeholder="Previous Due">
                            </div>
                        </div>
                        <div class="form-group m-0 row  mt-2">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Total Amount</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text" disabled v-model="form.currentTotalAmount" class="form-control" placeholder="Current Total Amount">
                            </div>
                        </div>
                        <div class="form-group m-0 row  mt-2">
                            <div class="col-md-4  col-sm-4 col-12 pl-0">
                                <label>Paid Amount</label>
                            </div>
                            <div class="col-md-7 col-sm-8 col-12 pl-0">
                              <input type="text" v-model="form.currentPaidAmount" class="form-control" placeholder="Current Paid Amount">
                            </div>
                        </div>
                     </div>
                  </form>
              </div>

              <div class="col-lg-3 col-12 mt-3 px-3">
                  <div class="due-bal">
                    <h5>Balance Due : <span id="blanceDue"> </span></h5>
                  </div>
                  <div class="total-bal">
                    <h5>Total : <span id="total"> </span></h5>
                  </div>
              </div>

            </div>
          </div>
       </div>



       <!-- -----------------------------   card footer  -->
 
<div class="d-block pt-3 pb-4 card-footer overflow-hidden p-0">
<div class="col-lg-7 px-lg-5 col-sm-8 offset-sm-2 col-12">


                                <button type="button" class="btn-pill btn-shadow btn-wide fsize-1 btn btn-outline-danger btn-lg float-left p-2">
                                    <span class="mr-2 opacity-7">
                                        <i class="fa fa-undo "></i>
                                    </span>
                                    <span class="mr-1"> Reset </span>
                                </button>

                                <button type="button" @click.prevent="salesInvoiceEntry()" class="btn-pill btn-shadow btn-wide fsize-1 btn btn-primary btn-lg float-right ">
                                    <span class="mr-2 opacity-7">
                                        <i class="fa fa-paper-plane"></i>
                                    </span>
                                    <span class="mr-1"> Save </span>
                                </button>


                            </div>
                            </div>
 
<!-- -----------------------------   // card footer  --> 



       </div>

       <div class="card main-card  element-block-example mt-5">
        <div class="card-header-tab card-header alert-info">
          <h4><i
            class="header-icon lnr-laptop-phone icon-gradient bg-premium-dark"
          ></i>
          View Information </h4>
         </div>
               <div class="card-body table-responsive bg-white">
        <table style="width: 100%;" id="example" class="table table-hover table-striped table-bordered">
             <thead>
                <tr>
                  <th>SN</th>
                  <th>Sales Date</th>
                  <th>Sales Invoice No</th>
                  <th>Customer Name</th>
                  <th>Total Quantity</th>
                  <th>Discount Price</th>
                  <th>Total Amount</th>
                  <th>Paid Amount</th>
                  <th>Due Amount</th>
                  <th>Action</th>
                </tr>
               </thead>
               <tbody>
                 <tr v-for="(salesInvoiceList, index) in salesInvoiceLists.data">
                   <td>{{ index+1 }}</td>
                   <td>{{ salesInvoiceList.salesDate }}</td>
                   <td>{{ salesInvoiceList.salesInvoiceNo }}</td>
                   <td>{{ salesInvoiceList.salesCustomerId }}</td>
                   <td>{{ salesInvoiceList.totalQuantity }}</td>
                   <td>{{ salesInvoiceList.discountPrice }}</td>
                   <td>{{ salesInvoiceList.currentTotalAmount }}</td>
                   <td>{{ salesInvoiceList.currentPaidAmount }}</td>
                   <td>
                      <span v-if="salesInvoiceList.previousDue !='' ">
                         {{ salesInvoiceList.previousDue }}
                      </span>
                      <span v-else>
                         ---
                      </span>
                   </td>
                   <td>
                     <router-link :to="`/productsale@edit${salesInvoiceList.salesInvoiceId}`" class="mr-2 btn-hover-shine btn btn-shadow btn-primary"><i class=" fa fa-edit"></i>Edit</router-link>
                   </td>
                 </tr>
               </tbody>
            </table>
          </div>
          <span class="card_footer">
            <pagination :data="salesInvoiceLists" :limit="limit"  @pagination-change-page="getPaginateList">
              <span slot="prev-nav">&lt; Previous</span>
              <span slot="next-nav">Next &gt;</span>
            </pagination>
         </span>
        </div>


       <!-- Customer  Modal -->
         <div class="modal fade" id="customerModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
           <div class="modal-dialog" role="document">
             <div class="modal-content">
               <div class="modal-header bg-primary text-light" >
                 <h5 class="modal-title" id="exampleModalLongTitle">Customer Information Entry</h5>
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span>
                 </button>
               </div>
                <form action="">
                   <div class="modal-body">
                     <div class="purchase-entry py-4 px-2">
                       <div class="col-12  supplier-border shadow-custom">
                           <div class="form-group">
                              <label>Customer Type</label>
                              <select  v-model="form.customerTypeId" name="customerTypeId" :class="{ 'is-invalid': form.errors.has('customerTypeId') }" class="form-control">
                                   <option  value="">Select One</option>
                                   <option v-for="customerTypeList in customerTypeLists" :value="customerTypeList.shopCustomerTypeEntryId">{{ customerTypeList.shopCustomerName }}</option>
                              </select>
                              <has-error :form="form" field="customerTypeId"></has-error>
                           </div>
                           <div class="form-group">
                               <label>Customer Name</label>
                               <input   type="text" v-model="form.customerName" name="customerName" :class="{ 'is-invalid': form.errors.has('customerName') }"  placeholder="Customer Name" class="form-control">
                               <has-error :form="form" field="customerName"></has-error>
                           </div>
                           <div class="form-group">
                               <label>Customer Email</label>
                               <input   type="text" v-model="form.customerEmail" name="customerEmail" :class="{ 'is-invalid': form.errors.has('customerEmail') }" placeholder="Customer Email" class="form-control">
                               <has-error :form="form" field="customerEmail"></has-error>
                           </div>
                           <div class="form-group">
                               <label>Customer Phone Number</label>
                               <input   type="text" v-model="form.customerPhone" name="customerPhone" :class="{ 'is-invalid': form.errors.has('customerPhone') }" placeholder="Customer Phone Number" class="form-control">
                               <has-error :form="form" field="customerPhone"></has-error>
                           </div>
                           <div class="form-group">
                               <label>Customer Imo Number</label>
                               <input   type="text"  v-model="form.customerImoNumber" name="customerImoNumber"  placeholder="Customer Imo Number" class="form-control">
                           </div>
                           <div class="form-group">
                               <label>Customer Facebook ID</label>
                               <input   type="text" v-model="form.customerFacebookID" name="customerFacebookID"  placeholder="Customer Facebook ID" class="form-control">
                           </div>
                           <div class="form-group">
                               <label>Customer Address</label>
                               <textarea   type="text" v-model="form.customerAddress" name="customerAddress" :class="{ 'is-invalid': form.errors.has('customerAddress') }" placeholder="Customer Address" class="form-control"></textarea>
                               <has-error :form="form" field="customerAddress"></has-error>
                           </div>
                       </div>
                    </div>
                     <div class="purchase-entry py-4 px-2">
                       <div class="col-12  supplier-border shadow-custom">
                          <h5 class="text-center">Customer Reference Information</h5>
                           <div class="form-group">
                               <label>Reference Name</label>
                               <input   type="text" v-model="form.referenceName" name="referenceName"  :class="{ 'is-invalid': form.errors.has('brandStatus') }" placeholder="Reference Name" class="form-control">
                           </div>
                           <div class="form-group">
                               <label>Reference Email</label>
                               <input   type="text" v-model="form.referenceEmail" name="referenceEmail"  :class="{ 'is-invalid': form.errors.has('brandStatus') }" placeholder="Reference Email" class="form-control">
                           </div>
                           <div class="form-group">
                               <label>Reference Phone Number</label>
                               <input   type="text" v-model="form.referencePhone" name="referencePhone"  :class="{ 'is-invalid': form.errors.has('brandStatus') }" placeholder="Reference Phone Number" class="form-control">
                           </div>
                       </div>
                    </div>
                  </div>
                </form>
                <div class="modal-footer">
                  <button type="button" class="btn btn-hover-shine btn-danger" data-dismiss="modal">Close</button>
                  <button  class="btn btn-hover-shine btn-success" @click.prevent="customerInformationEntry()" data-dismiss="modal" >Add Customer Information</button>
                </div>
             </div>
           </div>
         </div>

       <!-- Offer  Modal -->
         <div class="modal fade" id="offerModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
           <div class="modal-dialog" role="document">
             <div class="modal-content">
               <div class="modal-header bg-primary text-light" >
                 <h5 class="modal-title" id="exampleModalLongTitle">Offet Product List</h5>
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span>
                 </button>
               </div>
                 <div class="modal-body">
                   <div class="table-responsive bg-white shadow-price">
                     <table class="table table-hover table-bordered table-striped">
                       <thead>
                          <tr>
                            <th>SN</th>
                            <th>Product_Name</th>
                            <th>MRP_Price</th>
                            <th>Sales_Price</th>
                            <th>Wholesale_Price</th>
                            <th>Special_Price</th>
                            <th>E-Commerce_Price</th>
                          </tr>
                         </thead>
                         <tbody>
                           <tr v-for="(salesProductDiscountPriceReport, index) in salesProductDiscountPriceReports.data">
                             <td>{{ index+1 }}</td>
                             <td>{{ salesProductDiscountPriceReport.product_name.productName }} ({{ salesProductDiscountPriceReport.product_name.productCode }})</td>
                             <td>{{ salesProductDiscountPriceReport.mrpPrice }}</td>
                             <td>{{ salesProductDiscountPriceReport.salesPrice }}</td>
                             <td>{{ salesProductDiscountPriceReport.wholesalePrice }}</td>
                             <td>{{ salesProductDiscountPriceReport.specialPrice }}</td>
                             <td>{{ salesProductDiscountPriceReport.eCommercePrice }}</td>
                          </tr>
                       </tbody>
                    </table>
                   </div>
                 </div>
                 <span class="card_footer">
                   <pagination :data="salesProductDiscountPriceReports" :limit="limit"  @pagination-change-page="getPaginateList">
                     <span slot="prev-nav">&lt; Previous</span>
                     <span slot="next-nav">Next &gt;</span>
                   </pagination>
                </span>
                <div class="modal-footer">
                  <button type="button" class="btn btn-hover-shine btn-danger" data-dismiss="modal">Close</button>
                </div>
             </div>
           </div>
         </div>

       <!-- Stock  Modal -->
         <div class="modal fade" id="stockModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
           <div class="modal-dialog" role="document">
             <div class="modal-content">
               <div class="modal-header bg-primary text-light" >
                 <h5 class="modal-title" id="exampleModalLongTitle">Stock Product List</h5>
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span>
                 </button>
               </div>
                 <div class="modal-body">
                   <div class="table-responsive bg-white shadow-price">
                     <table class="table table-hover table-bordered table-striped">
                       <thead>
                          <tr>
                            <th>SN</th>
                            <th>Product_Name</th>
                            <th>MRP_Price</th>
                            <th>Sales_Price</th>
                            <th>Wholesale_Price</th>
                            <th>Special_Price</th>
                            <th>E-Commerce_Price</th>
                          </tr>
                         </thead>
                         <tbody>
                           <tr v-for="(salesProductPriceList, index) in salesProductPriceLists.data">
                             <td>{{ index+1 }}</td>
                             <td>{{ salesProductPriceList.product_name.productName }} ({{ salesProductPriceList.product_name.productCode }})</td>
                             <td>{{ salesProductPriceList.mrpPrice }}</td>
                             <td>{{ salesProductPriceList.salesPrice }}</td>
                             <td>{{ salesProductPriceList.wholesalePrice }}</td>
                             <td>{{ salesProductPriceList.specialPrice }}</td>
                             <td>{{ salesProductPriceList.eCommercePrice }}</td>
                           </tr>
                       </tbody>
                    </table>
                   </div>
                 </div>
                 <span class="card_footer">
                   <pagination :data="salesProductPriceLists" :limit="limit"  @pagination-change-page="getPaginateList">
                     <span slot="prev-nav">&lt; Previous</span>
                     <span slot="next-nav">Next &gt;</span>
                   </pagination>
                 </span>
                <div class="modal-footer">
                  <button type="button" class="btn btn-hover-shine btn-danger" data-dismiss="modal">Close</button>
                </div>
             </div>
           </div>
         </div>

       <!-- Stock  Modal -->
         <div class="modal fade" id="stockLimitModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
           <div class="modal-dialog" role="document">
             <div class="modal-content">
               <div class="modal-header bg-primary text-light" >
                 <h5 class="modal-title" id="exampleModalLongTitle">Stock Limit Product List</h5>
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span>
                 </button>
               </div>
                 <div class="modal-body">
                   <div class="table-responsive bg-white shadow-price">
                     <table class="table table-hover table-bordered table-striped">
                       <thead>
                          <tr>
                            <th>SN</th>
                            <th>Product_Name</th>
                            <th>Alert_Quantity</th>
                            <th>MRP_Price</th>
                            <th>Sales_Price</th>
                            <th>Wholesale_Price</th>
                            <th>Special_Price</th>
                            <th>E-Commerce_Price</th>
                          </tr>
                         </thead>
                         <tbody>
                           <tr v-for="(alertQuantityProductList, index) in alertQuantityProductLists.data" v-if="alertQuantityProductList.quantity <= alertQuantityProductList.alertQuantity">
                             <td>{{ index+1 }}</td>
                             <td>{{ alertQuantityProductList.product_name.productName }} ({{ alertQuantityProductList.product_name.productCode }})</td>
                             <td>{{ alertQuantityProductList.alertQuantity }}</td>
                             <td>{{ alertQuantityProductList.mrpPrice }}</td>
                             <td>{{ alertQuantityProductList.salesPrice }}</td>
                             <td>{{ alertQuantityProductList.wholesalePrice }}</td>
                             <td>{{ alertQuantityProductList.specialPrice }}</td>
                             <td>{{ alertQuantityProductList.eCommercePrice }}</td>
                           </tr>
                        </tbody>
                    </table>
                   </div>
                 </div>
                 <span class="card_footer">
                   <pagination :data="alertQuantityProductLists" :limit="limit"  @pagination-change-page="getPaginateList">
                     <span slot="prev-nav">&lt; Previous</span>
                     <span slot="next-nav">Next &gt;</span>
                   </pagination>
                 </span>
                <div class="modal-footer">
                  <button type="button" class="btn btn-hover-shine btn-danger" data-dismiss="modal">Close</button>
                </div>
             </div>
           </div>
         </div>

    </span>
</template>

<script>
import  Lodaingpage from './../../lodaing@page';
import Datepicker from 'vuejs-datepicker';
import Multiselect from 'vue-multiselect'
import moment from 'moment'

    export default {
      data(){
          return{
              form: new Form({
                  customerName:'',
                  customerEmail:'',
                  customerPhone:'',
                  customerTypeId:'',
                  customerImoNumber:'',
                  customerFacebookID:'',
                  customerAddress: '',
                  referenceName: '',
                  referenceEmail: '',
                  referencePhone: '',
                  //
                  salesDate:'',
                  priceType:'',
                  salesInvoiceNo:'',
                  salesCustomerEntryId:'',

                  purchaseProductId:'',
                  unitId:'',
                  brandId:'',
                  quantity:'',
                  unitPrice:'',
                  discountPriceHidden:'',
                  totalPrice:'',

                  //  footer Form
                  totalQuantity:'',
                  totalBalance:'',
                  discountPrice:'',
                  totalVat:'',
                  vatCalculate:'',
                  totalPayable:'',
                  previousDue:'',
                  currentTotalAmount:'',
                  currentPaidAmount:'',

              }),
              priceType: [
                { id: 1, priceName: 'MRP Price' },
                { id: 2, priceName: 'Sales Price' },
                { id: 3, priceName: 'Wholesale Price' },
                { id: 4, priceName: 'Special Price' },
                { id: 5, priceName: 'E-Commerce Price' },
              ],
              brandLists:[],
              uniteLists:[],
              productPriceLists:[],
              customerTypeLists:[],
              salesCustomerLists:[],
              salesProductPriceLists:{},
              alertQuantityProductLists:{},
              salesProductDiscountPriceReports:{},

              purchaseProductId:{},
              salesProductLists:{},
              salesInvoiceNoIncre:{},
              salesInvoiceLists:{},
          }
      },
      components: {
          Lodaingpage,
          Datepicker,
          Multiselect,
      },
      props:{
           limit: {
             type: Number,
             default: 2
         }
      },
      mounted() {
          this.totalBalance();
          this.getPaginateList()
          this.salesInvoiceList()
          this.salesProductList()
          this.customerTypeList()
          this.productPriceSetupList()
          this.productDiscountPriceList()
      },
      methods: {

          customerTypeName ({shopCustomerName}) {
             return `${shopCustomerName}`
          },
          salesCustomerName ({customerName}) {
             return `${customerName}`
          },
          priceName ({priceName}) {
             return `${priceName}`
          },
          prdouctName ({product_name}) {
             return `${product_name.productName} (${product_name.productCode})`
          },
          brandName ({brandName}) {
             return `${brandName}`
          },
          uniteName({uniteEntryName}) {
             return `${uniteEntryName}`
          },
          customFormatter(date) {
            return moment(date).format('DD-MM-YYYY');
          },
          customerTypeList() {
              axios.get('/salesProductEntry/create').then(res => {
                  this.uniteLists = res.data.uniteLists
                  this.brandLists = res.data.brandLists
                  this.customerTypeLists = res.data.customerTypeLists
                  this.productPriceLists = res.data.productPriceLists
              })
          },
          customerTypeIdCatch(){
              axios.get('/customerTypeIdCatch/'+this.form.customerTypeId.shopCustomerTypeEntryId).then(res => {
                  this.salesCustomerLists = res.data.salesCustomerLists
              })
          },
          customerIdCatch(){
              axios.get('/customerIdCatch/'+this.form.salesCustomerEntryId.salesCustomerEntryId).then(res => {
                  this.form.previousDue = res.data.customerPreviousDue;
                  $('#blanceDue').text(res.data.customerPreviousDue);
              })
          },
          purchaseProductIdCatch(value){
              if (this.form.priceType != "") {
                  this.purchaseProductId = value.purchaseProductId;
                  axios.get('/purchaseProductIdCatch/'+this.purchaseProductId+'/'+this.form.priceType.id).then(res => {
                       this.form.unitPrice = res.data.price;

                       if (res.data.discountPrice != null) {
                           this.form.discountPriceHidden = res.data.discountPrice;
                       }
                       else{
                          this.form.discountPriceHidden = "";
                       }
                  })
              }
              else{
                  Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Select Price Type!',
                  })
                  this.form.purchaseProductId = "";
              }
          },
          customerInformationEntry() {
              this.form.post('/customerInformationEntry').then(res => {
                  Toast.fire({
                    icon: 'success',
                    title: 'Customer Information Entry successfully'
                  })
                  this.form.reset();
              })
          },
          totalPrice(){
              let quantity = this.form.quantity;
              let unitPrice = this.form.unitPrice;
              let totalPrice = quantity * unitPrice;
              this.form.totalPrice = totalPrice;
          },
          salesProductEntry(){
             this.form.post('/salesProductEntry').then(res =>{
                 if (res.data.alReadyEntry) {
                     Swal.fire({
                         icon: 'error',
                         title: 'Oops...',
                         text: 'Already Product Entry!',
                         showCancelButton: true,
                         confirmButtonColor: '#3085d6',
                         cancelButtonColor: '#d33',
                         confirmButtonText: 'Product Quantity Update'
                       }).then( res => {
                         this.form.post('/salesProductQuantityUpdate').then(res => {
                             Swal.fire(
                               'Successfully!',
                               'Product Quantity has been Updated',
                             )
                             this.form.purchaseProductId = "";
                             this.form.unitId = "";
                             this.form.brandId = "";
                             this.form.quantity = "";
                             this.form.unitPrice = "";
                             this.form.totalPrice = "";
                             this.salesProductList();
                         });
                     })
                 }
                 else {
                    Toast.fire({
                       icon: 'success',
                       title: 'Sales Product Entry Successfully'
                    })
                    this.form.purchaseProductId = "";
                    this.form.unitId = "";
                    this.form.brandId = "";
                    this.form.quantity = "";
                    this.form.unitPrice = "";
                    this.form.totalPrice = "";
                    this.salesProductList();
                    this.totalBalance();
                }
             })
          },
          salesProductList(){
              axios.get('/salesProductEntry').then(res =>{
                  this.salesProductLists = res.data.salesProductLists
                  this.totalBalance();
              })
          },
          salesInvoiceEntry(){
              axios.post('/salesInvoiceEntry',{
                  salesDate          : this.form.salesDate,
                  salesInvoiceNo     : this.form.salesInvoiceNo,
                  salesCustomerTypeId : this.form.customerTypeId,
                  salesCustomerId    : this.form.salesCustomerEntryId,
                  totalQuantity      : this.form.totalQuantity,
                  totalBalance       : this.form.totalBalance,
                  discountPrice      : this.form.discountPrice,
                  totalVat           : this.form.totalVat,
                  vatCalculate       : this.form.vatCalculate,
                  totalPayable       : this.form.totalPayable,
                  previousDue        : this.form.previousDue,
                  currentTotalAmount : this.form.currentTotalAmount,
                  currentPaidAmount  : this.form.currentPaidAmount,
              })
              .then(res => {
                  Toast.fire({
                      icon: 'success',
                      title: 'Sales Invoice Entry Successfully'
                  })
                  this.form.reset();
                  $('#total').html('');
                  $('#blanceDue').text('');
                  this.salesInvoiceList();
              })
              .catch(error =>{
                  Toast.fire({
                      icon: 'error',
                      title: 'Something Worng'
                  })
              })
          },
          salesInvoiceList(){
              axios.get('/salesInvoiceEntry').then(res => {
                  this.form.salesInvoiceNo = res.data.salesInvoiceNo; // same value
                  this.salesInvoiceNoIncre = res.data.salesInvoiceNo; // same value
                  this.salesInvoiceLists = res.data.salesInvoiceLists;
                  this.form.salesDate = res.data.currentDate;
              })
          },
          totalBalance(){
              axios.get('/salesTotalBalanceWithInvoice/'+this.salesInvoiceNoIncre).then(res =>{
                  let totalBalance = 0;
                  let discountPrice = 0;
                  let totalQuantity = 0;

                  res.data.salesTotalBalances.forEach( salesTotalBalance => {
                      if (salesTotalBalance.discountPriceHidden != null) {
                          let totalDiscount =	salesTotalBalance.quantity * salesTotalBalance.discountPriceHidden;
                          totalBalance += parseFloat(totalDiscount);
                      }
                      else{
                          totalBalance += parseFloat(salesTotalBalance.totalPrice);
                      }

                        discountPrice += parseFloat(salesTotalBalance.totalPrice);
                        totalQuantity += parseFloat(salesTotalBalance.quantity);
                  });

                  this.form.totalQuantity =  totalQuantity;
                  this.form.totalBalance =  totalBalance;
                  this.form.totalPayable =  totalBalance;
                  this.form.vatCalculate =  totalBalance;
                  this.form.currentTotalAmount =  totalBalance;
                  $('#total').html(totalBalance);
                  this.form.discountPrice = parseFloat(discountPrice)  - parseFloat(this.form.totalBalance);
                  if (this.form.previousDue != "") {
                      this.form.currentTotalAmount = parseFloat(this.form.previousDue) + parseFloat(totalBalance);
                  }
              })
          },
          totalVat(){
                if (this.form.totalVat != "") {
                    let totalVat = parseFloat(this.form.totalBalance)  * parseFloat(this.form.totalVat) / 100;
                    this.form.totalPayable = parseFloat(this.form.vatCalculate) + parseFloat(totalVat);
                    this.form.currentTotalAmount = parseFloat(this.form.vatCalculate) + parseFloat(totalVat);
                }
                else{
                    this.form.totalPayable = this.form.totalBalance
                    this.form.currentTotalAmount = this.form.totalBalance
                }
          },
          salesProductDelete(salesProdcutId){
             axios.delete('/salesProductEntry/'+salesProdcutId).then(res =>{
                 Toast.fire({
                    icon: 'success',
                    title: 'Sales Product Delete Successfully'
                 })
                 this.salesProductList();
                 this.totalBalance();
             })
          },
          productPriceSetupList(){
            axios.get('/salesStackProductWithPrice').then(res =>{
                this.salesProductPriceLists =  res.data.salesProductPriceLists
                this.alertQuantityProductLists =  res.data.alertQuantityProductLists
            })
          },
          getPaginateList(page = 1){
            axios.get('/salesStackProductWithPrice?page=' + page).then(response => {
                 this.salesProductPriceLists = response.data.salesProductPriceLists;
                 this.alertQuantityProductLists = response.data.alertQuantityProductLists;
            });
          },
          productDiscountPriceList() {
            axios.get('/salesProductDiscountPriceReport').then(res => {
                this.salesProductDiscountPriceReports = res.data.salesProductDiscountPriceReports
            })
          },
          getPaginateList(page = 1){
            axios.get('/salesProductDiscountPriceReport?page=' + page).then(response => {
                this.salesProductDiscountPriceReports = response.data.salesProductDiscountPriceReports;
            });
          },
          getPaginateList(page = 1){
             axios.get('/salesInvoiceEntry?page=' + page).then(response => {
                 this.salesInvoiceLists = response.data.salesInvoiceLists;
             });
          },
          salesInvoiceReset(){
              this.form.reset();
              $('#total').html('');
              this.salesInvoiceList();
          },
       }
    }
</script>
<style media="screen">
  .shadow-price{
      box-shadow: 0 2px 3px rgba(0,0,0,0.15) !important;
  }
  .salesDate input{
      background-color: #fff;
      border: 1px solid #ced4da;
      border-radius: .25rem;
      padding: 9px 20px;
      width: 90%;
  }
  .product-delete i{
      cursor: pointer;
  }
</style>
